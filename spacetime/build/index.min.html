<svg class="splitLeft" viewBox="0 0 100 100"><defs><clipPath id="planetClip"><circle r="100"/></clipPath><mask id="planetShadowClip"><circle cx="0" cy="0" r="100" fill="white" /><circle cx="-25" cy="0" r="100" fill="black" /></mask><radialGradient id="sungrad" cx="0" cy="0" r="100" gradientUnits="userSpaceOnUse"><stop offset="0" style="stop-color:#F7C000"/><stop offset="0.3137" style="stop-color:#F7BD01"/><stop offset="0.5387" style="stop-color:#F7B405"/><stop offset="0.7359" style="stop-color:#F7A40B"/><stop offset="0.9162" style="stop-color:#F78E13"/><stop offset="1" style="stop-color:#F78118"/></radialGradient><linearGradient id="gradient1"><stop offset="0" stop-color="#71C937" stop-opacity="0"/><stop offset="1" stop-color="#83FF30"/></linearGradient></defs><g class="bottomLayer"></g><g id="solarSystemLayer"><g class="stars"></g><g id="solarSystem"><g class="planetLayer"></g></g></g><g class="topLayer"></g><g class="glitchLayer"></g></svg><svg class="splitRight" viewBox="0 0 100 100"><defs><clipPath id="planetClip"><circle r="100"/></clipPath><mask id="planetShadowClip"><circle cx="0" cy="0" r="100" fill="white" /><circle cx="-25" cy="0" r="100" fill="black" /></mask><radialGradient id="sungrad" cx="0" cy="0" r="100" gradientUnits="userSpaceOnUse"><stop offset="0" style="stop-color:#F7C000"/><stop offset="0.3137" style="stop-color:#F7BD01"/><stop offset="0.5387" style="stop-color:#F7B405"/><stop offset="0.7359" style="stop-color:#F7A40B"/><stop offset="0.9162" style="stop-color:#F78E13"/><stop offset="1" style="stop-color:#F78118"/></radialGradient><linearGradient id="gradient1"><stop offset="0" stop-color="#71C937" stop-opacity="0"/><stop offset="1" stop-color="#83FF30"/></linearGradient></defs><g class="bottomLayer"></g><g class="solarSystemLayer"><g class="stars"></g><g class="solarSystem"><g class="planetLayer"></g></g></g><g class="topLayer"></g><g class="glitchLayer"></g></svg><div id="svgStartNode" class="absCenter"><h1 id="title">SPACETIME</h1><div id="gameType"><div class="link cpu" onclick="setGameState(false, low)">Player vs CPU</div><div class="link split" onclick="setGameState(true, low)">Player vs Player (Split Screen)</div></div><div id="gameQuality"><div class="link high" onclick="setGameState(split, false)">High Quality</div><div class="link low" onclick="setGameState(split, true)">Low Quality</div></div><div id="helperText"><h3 id="startText" class="blink">Press Button to Join!</h3><h3>PC [Arrows] [CTRL] [SHIFT] / XBox Controller [RT] [A] [B]</h3></div></div><div id="svgDeadNode" class="absCenter" style="display: none"><h1>YOU DIED!</h1><h4><span>Coding & Graphics</span>https://github.com/petah<br>https://github.com/reybenher</h4><h4><span>Ships</span>http://kenney.nl/assets</h4><h4><span>Sound</span>https://github.com/grumdrig/jsfxr<br>http://humphd.github.io/sfxr.js/</h4></div><div id="hudLayer" class="hud"></div><div id="hudLayerBottom" class="hud" style="display: none;"><div>KILLS: <span id="killCount">0</span></div><div>LAPSE: <span id="elapsedTime">0</span>s</div></div><svg style="display: none"><g id="ay" class="player1" transform="translate(0 0) rotate(90)"><g id="ax" transform="translate(-33.5 -26.5) rotate(0) scale(0.7)"><path class="playerBoat0" d="M46.7,2H46l-5.9,13l-0.3,0.3l-1.4-1.4l5.8-12.7c0.1-0.4,0.4-0.7,0.8-0.9C45.3,0.1,45.6,0,46,0h0.7V2 M27.3,63.6 l9.4,9.3h24.3l9.4-9.3l0.8,2l-8.8,8.8c-0.4,0.4-0.9,0.6-1.4,0.6H36.6c-0.6,0-1-0.2-1.4-0.6l-8.8-8.8L27.3,63.6 M57.3,15L51.5,2h-0.7 V0h0.7c0.4,0,0.8,0.1,1.1,0.3l0.8,0.9L59,13.9L57.3,15"/><path class="playerBoat1" d="M57.3,15l19.1,42.4L73,60.8l-2.8,2.8l-9.4,9.3H36.6l-9.4-9.3l-2.8-2.8L21,57.3L40.1,15L46,2h0.7L30.3,53.9 l6.5,11.8h24l6.5-11.8L50.8,2h0.7L57.3,15"/><path class="playerBoat2" d="M46.7,2V0h4v2H46.7 M92.4,53.3l4.6,5.4c0.3,0.4,0.5,0.8,0.5,1.3v4.7c0,0.6-0.2,1-0.6,1.4 c-0.4,0.4-0.9,0.6-1.4,0.6h-5.3h-0.3l0.3-2h5.3v-4.7l-3.6-4.3L92.4,53.3 M7.6,66.7l-0.4,0.1H2c-0.6,0-1-0.2-1.4-0.6 C0.2,65.8,0,65.3,0,64.8v-4.7c0-0.5,0.2-0.9,0.5-1.3L5,53.4l0.6,2.4L2,60.1v4.7h5.3L7.6,66.7"/><path class="playerBoat3" d="M50.8,2l16.5,51.9l-6.5,11.8h-24l-6.5-11.8L46.7,2H50.8 M40,33.1l-0.3,1h18l-0.3-1L51,10.8h-4.6L40,33.1 L40,33.1 M91,60.8l0.9-5l3.6,4.3v4.7h-5.3l0.3-1.2L91,60.8 M7,63.6l0.3,1.2H2v-4.7l3.6-4.3l0.9,5L7,63.6"/><path class="playerBoat4" d="M38.5,13.9l1.4,1.4l-7,8.3L5.6,55.8L5,53.4L38.5,13.9 M57.3,15l1.7-1l33.4,39.4l-0.5,2.5L64.5,23.6L57.3,15"/><path class="playerBoat5" d="M57.3,15l7.3,8.6l16.2,33.6l-3.6,3.6H73l3.4-3.5L57.3,15 M39.9,15.3l0.3-0.3L21,57.3l3.5,3.5h-4.1l-3.6-3.6 l16.1-33.6L39.9,15.3"/><path class="playerBoat6" d="M57.5,33.1l0.3,1h-18l0.3-1l6.4-20.3H51L57.5,33.1"/><path class="playerBoat7" d="M57.5,33.1L51,12.8h-4.6L40,33.1h0l6.5-22.3H51L57.5,33.1"/><path class="playerBoat8" d="M64.5,23.6l27.3,32.3l-0.9,5H77.1l3.6-3.6L64.5,23.6 M5.6,55.8l27.3-32.3L16.8,57.2l3.6,3.6H6.5L5.6,55.8"/><path class="playerBoat9" d="M89.9,66.8l-0.8-0.3l-0.7-0.8H71l-0.8-2h4.1h16.1l-0.3,1.2L89.9,66.8 M26.4,65.6H9.1l-0.8,0.8l-0.7,0.3 l-0.4-1.9L7,63.6h16.1h4.1L26.4,65.6"/><path class="playerBoat10" d="M24.5,60.8l2.8,2.8h-4.1l-2.8-2.8H24.5 M70.2,63.6l2.8-2.8h4.1l-2.8,2.8H70.2"/><path class="playerBoat11" d="M77.1,60.8H91l-0.5,2.8H74.4L77.1,60.8 M23.1,63.6H7l-0.5-2.8h13.9L23.1,63.6"/></g><g><g transform="translate(0 0)"><polygon class="pointer" transform="rotate(0)" points="20 0 0 -8 0 8"/></g></g></g><circle id="starNode"/><g id="glitchParticle" transform="translate(0 0)"><rect x="-5" y="-15" width="10" height="30" class="planetOrange3" transform="rotate(0) scale(1)" /></g><g id="bubbleParticle" transform="translate(0 0)"><circle class="bubbleParticle" r="2" style="opacity:.4"/></g><g id="explosion" transform="translate(0 0)"><circle class="explosion" /></g><g id="bullet" transform="translate(0 0)"><polygon class="bullet" transform="translate(0 0) rotate(0)" points="-25 0 0 3 3 0 0 -3"/></g><g id="sunStar" transform="translate(0 0) scale(1)"><circle class="sunMain" cx="0" cy="0" r="100" fill="url(#sungrad)"/><circle class="sunRing sunRing1" cx="0" cy="0" r="135"/><circle class="sunRing sunRing2" cx="0" cy="0" r="168.5"/><circle class="sunRing sunRing3" cx="0" cy="0" r="200" transform="rotate(0)"/></g><g id="planetBlue" transform="translate(0 0) scale(1)" clip-path="url(#planetClip)"><circle class="planetBlue1" r="100"/><ellipse class="planetBlue3" cx="45" cy="-40" rx="90" ry="45"/><ellipse class="planetBlue2" cx="8" cy="-30" rx="26" ry="14"/><ellipse class="planetBlue3" cx="-5" cy="30" rx="20" ry="12"/><ellipse class="planetBlue3" cx="-20" cy="55" rx="38" ry="22"/><circle r="100" class="planetBlue4" mask="url(#planetShadowClip)" transform="rotate(0)"/></g><g id="planetGrey" transform="translate(0 0) scale(1)" clip-path="url(#planetClip)"><circle class="planetGrey2" r="100"/><circle class="planetGrey3" cx="-70" cy="-70" r="20"/><circle class="planetGrey3" cx="-22" cy="-22" r="20"/><circle class="planetGrey3" cx="46" cy="-48" r="28"/><circle class="planetGrey3" cx="64" cy="-24" r="12"/><circle class="planetGrey3" cx="-70" cy="48" r="38"/><circle class="planetGrey3" cx="34" cy="32" r="36"/><circle class="planetGrey3" cx="-10" cy="54" r="6"/><circle class="planetGrey3" cx="0" cy="68" r="6"/><circle class="planetGrey3" cx="16" cy="76" r="6"/><circle r="100" class="planetGrey4" mask="url(#planetShadowClip)" transform="rotate(0)"/></g><g id="planetOrange" transform="translate(0 0) scale(1)" clip-path="url(#planetClip)"><circle r="100" class="planetOrange2"/><rect x="-120" y="-70" width="90" height="30" rx="15" ry="15" class="planetOrange3"/><rect x="-120" y="-55" width="130" height="30" rx="15" ry="15" class="planetOrange3"/><rect x="-120" y="-40" width="70" height="30" rx="15" ry="15" class="planetOrange3"/><rect x="50" y="0" width="90" height="30" rx="15" ry="15" class="planetOrange3"/><rect x="-40" y="15" width="200" height="30" rx="15" ry="15" class="planetOrange3"/><rect x="10" y="75" width="90" height="30" rx="15" ry="15" class="planetOrange3"/><circle r="100" class="planetOrange4" mask="url(#planetShadowClip)" transform="rotate(0)"/></g></svg><svg id="hud" transform="translate(0 0) scale(1 1)" width="436" height="86" style="display: none"><g id="hudBase"><polygon class="hudBase" points="436,48 136,48 120,86 0,86 0,46 436,46" transform="translate(0 0) scale(1 1)"/><text class="hudText" transform="translate(10 76)"></text></g><g id="hudBars"><rect x="0" y="0" class="hudBar" width="16" height="36"/></g></svg><style>body,svg{width:100vw;height:100vh}body{position:relative;margin:0;overflow:hidden;background-image:linear-gradient(135deg,#280023 0,#111c23 100%);font-family:Helvetica;font-size:18px;color:#fff}svg{position:fixed;top:0;left:0;shape-rendering:optimizeSpeed}.absCenter{position:absolute;margin:auto;left:0;right:0;top:0;bottom:0;text-align:center}svg text.absCenter{transform:translate(50vw,50vh);text-anchor:middle;fill:#fff;font-size:50px;font-family:monospace}.splitLeft{width:50vw;border-right:1px dotted rgba(255,255,255,.3)}.splitRight{width:50vw;right:0;left:auto}#svgDeadNode text,#svgStartNode text{text-anchor:middle;fill:#fff;font-family:monospace;font-size:30px}#svgStartNode #title{font-size:70px;font-weight:700}.bullet{fill:url(#gradient1)}.bubbleParticle{fill:#fff}.pointer{fill:RGBA(255,255,255,.7)}.playerBoat0{fill:#CBCBCB}.playerBoat1{fill:#F2F2F2}.playerBoat4{fill:#8EA8AD}.playerBoat5{fill:#BDD6DB}.playerBoat6{fill:#4A3C55}.playerBoat7{fill:#C44D4D}.playerBoat8{fill:#D3E1E7}.playerBoat9{fill:#BF9900}.playerBoat10{fill:#ECBD02}.playerBoat11{fill:#FC0}.player1 .playerBoat2{fill:#1884B4}.player1 .playerBoat3{fill:#36BBF5}.player2 .playerBoat2{fill:#802B2B}.player2 .playerBoat3{fill:#AC3939}.sunMain{stroke:#F78118;stroke-width:8}.sunRing{fill:none;stroke:#F78118;enable-background:new}.sunRing1,.sunRing2,.sunRing3{stroke-miterlimit:10}.sunRing1{opacity:.15;stroke-width:8}.sunRing2{opacity:.1;stroke-width:6;stroke-dasharray:52.7219,52.7219}.hudBar,.sunRing3{stroke-width:3}.sunRing3{opacity:.05;stroke-dasharray:30.4037,30.4037}.planetBlue1{fill:#1A6189}.planetBlue2{fill:#2574A9}.planetBlue3{fill:#63BCB8}.planetBlue4{opacity:.3;fill:#1A6189}.planetGrey1{fill:#989899}.planetGrey2{fill:#C2C2C2}.planetGrey3{fill:#ACBD86}.planetGrey4{opacity:.7;fill:#989899}.planetOrange1{fill:#B7532C}.planetOrange2{fill:#DD6B38}.planetOrange3{fill:#F39C12}.planetOrange4{opacity:.5;fill:#71361f}.hud{position:fixed;left:10px;right:10px;top:10px;bottom:auto}.hudText{font-size:1.4em;letter-spacing:1}.hudBase{fill:#66D9EF}#hudLayer>svg{position:absolute;top:0;left:0;right:auto;width:auto;height:auto}#hudLayer>svg.hudRight{left:auto;right:0}#hudLife .hudBar{fill:#F1C40F;stroke:#F1C40F}#hudLife .hudBarE{fill:none}#hudGlitch .hudBar{fill:#4eba6f;stroke:#4eba6f}#hudGlitch .hudBarE{fill:none}#hudLayerBottom{top:auto;bottom:10px;text-align:center;font-weight:700;color:#fff;font-size:22px;opacity:.35}#hudLayerBottom>div{display:inline-block;margin:0 1em}#svgStartNode{height:500px}#svgDeadNode{height:400px}#svgDeadNode span{display:block;color:#ac5eef}.link{border:3px solid #841cdc;display:inline-block;width:300px;padding:1em;margin:0 10px 30px;cursor:pointer}.link:hover{border-color:#ac5eef}.link.active{background-color:rgba(138,28,220,.15)}.blink{animation:blink 1s step-start 0s infinite;-webkit-animation:blink 1s step-start 0s infinite}@keyframes blink{50%{opacity:0}}@-webkit-keyframes blink{50%{opacity:0}}</style><script>function SfxrParams(){this.setSettings=function(c){for(let d=0;d<24;d++)this[String.fromCharCode(97+d)]=c[d]||0;this.c<.01&&(this.c=.01);let b=this.b+this.c+this.e;if(b<.18){let a=.18/b;this.b*=a,this.c*=a,this.e*=a}}}function SfxrSynth(){this._params=new SfxrParams;let e,c,d,b,h,g,l,i,j,f,a,k;this.reset=function(){let c=this._params;b=100/(c.f*c.f+.001),h=100/(c.g*c.g+.001),g=1-c.h*c.h*c.h*.01,l=-c.i*c.i*c.i*1e-6,c.a||(a=.5-c.n/2,k=-c.o*5e-5),i=1+c.l*c.l*(c.l>0?-.9:10),j=0,f=c.m==1?0:(1-c.m)*(1-c.m)*2e4+32},this.totalReset=function(){this.reset();let a=this._params;return e=a.b*a.b*1e5,c=a.c*a.c*1e5,d=a.e*a.e*1e5+12,((e+c+d)/3|0)*3},this.synthWave=function(a0,U){let m=this._params;let N=m.s!=1||m.v,t=m.v*m.v*.1,L=1+m.w*3e-4,q=m.s*m.s*m.s*.1,Y=1+m.t*1e-4,_=m.s!=1,Q=m.x*m.x,S=m.g,O=m.q||m.r,W=m.r*m.r*m.r*.2,H=m.q*m.q*(m.q<0?-1020:1020),I=m.p?((1-m.p)*(1-m.p)*2e4|0)+32:0,Z=m.d,J=m.j/2,$=m.k*m.k*.01,G=m.a;let F=e,T=1/e,X=1/c,V=1/d;let x=5/(1+m.u*m.u*20)*(.01+q);x>.8&&(x=.8),x=1-x;let D=!1,P=0,v=0,u=0,C=0,A=0,R,y=0,o,r=0,s,E=0,p,M=0,n,z,K=0;let B=new Array(1024),w=new Array(32);for(let a=B.length;a--;)B[a]=0;for(let a=w.length;a--;)w[a]=Math.random()*2-1;for(let e=0;e<U;e++){if(D)return e;if(I&&++M>=I&&(M=0,this.reset()),f&&++j>=f&&(f=0,b*=i),g+=l,b*=g,b>h&&(b=h,S>0&&(D=!0)),o=b,J>0&&(K+=$,o*=1+Math.sin(K)*J),o|=0,o<8&&(o=8),G||(a+=k,a<0?a=0:a>.5&&(a=.5)),++v>F){v=0;switch(++P){case 1:F=c;break;case 2:F=d}}switch(P){case 0:u=v*T;break;case 1:u=1+(1-v*X)*2*Z;break;case 2:u=1-v*V;break;case 3:u=0;D=!0}O&&(H+=W,s=H|0,s<0?s=-s:s>1023&&(s=1023)),N&&L&&(t*=L,t<1e-5?t=1e-5:t>.1&&(t=.1)),z=0;for(let b=8;b--;){if(r++,r>=o&&(r%=o,G==3))for(let a=w.length;a--;)w[a]=Math.random()*2-1;switch(G){case 0:n=r/o<a?.5:-.5;break;case 1:n=1-r/o*2;break;case 2:p=r/o;p=(p>.5?p-1:p)*6.28318531;n=1.27323954*p+.405284735*p*p*(p<0?1:-1);n=.225*((n<0?-1:1)*n*n-n)+n;break;case 3:n=w[Math.abs(r*32/o|0)]}N&&(R=y,q*=Y,q<0?q=0:q>.1&&(q=.1),_?(A+=(n-y)*q,A*=x):(y=n,A=0),y+=A,C+=y-R,C*=1-t,n=C),O&&(B[E%1024]=n,n+=B[(E-s+1024)%1024],E++),z+=n}z*=.125*u*Q,a0[e]=z>=1?32767:z<=-1?-32768:z*32767|0}return U}}let synth=new SfxrSynth;let jsfxr=function(i){synth._params.setSettings(i);let g=synth.totalReset();let b=new Uint8Array(((g+1)/2|0)*4+44);let d=synth.synthWave(new Uint16Array(b.buffer,44),g)*2;let a=new Uint32Array(b.buffer,0,44);a[0]=1179011410,a[1]=d+36,a[2]=1163280727,a[3]=544501094,a[4]=16,a[5]=65537,a[6]=44100,a[7]=88200,a[8]=1048578,a[9]=1635017060,a[10]=d,d+=44;let c=0,e='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',h='data:audio/wav;base64,';for(;c<d;c+=3){let f=b[c]<<16|b[c+1]<<8|b[c+2];h+=e[f>>18]+e[f>>12&63]+e[f>>6&63]+e[f&63]}return h};createSound=b=>{let a=[];for(let c=0;c<10;c++){let e=jsfxr(b);let d=new Audio;d.src=e,a.push(d)}return a},playSound=(b,c,d)=>{let a=2e3;for(let e=0;e<panes.length;e++){let f=n(panes[e].viewBox.baseVal.x+window.innerWidth*zoom/2,panes[e].viewBox.baseVal.y+window.innerHeight*zoom/2,c,d);f<a&&(a=f)}a<2e3&&(w=b.shift(),w.volume=-(5e-4*a)+1,w.play(),b.push(w))},soundGenerator=(()=>{defaultSynth={waveType:0,startFrequency:.3,minFrequency:0,slide:0,deltaSlide:0,squareDuty:0,dutySweep:0,vibratoDepth:0,vibratoSpeed:0,attackTime:0,sustainTime:.3,decayTime:.4,sustainPunch:0,lpFilterResonance:0,lpFilterCutoff:1,lpFilterCutoffSweep:0,hpFilterCutoff:0,hpFilterCutoffSweep:0,phaserOffset:0,phaserSweep:0,repeatSpeed:0,changeSpeed:0,changeAmount:0};let a=a=>[a.waveType,a.attackTime,a.sustainTime,a.sustainPunch,a.decayTime,a.startFrequency,a.minFrequency,a.slide,a.deltaSlide,a.vibratoDepth,a.vibratoSpeed,a.changeAmount,a.changeSpeed,a.squareDuty,a.dutySweep,a.repeatSpeed,a.phaserOffset,a.phaserSweep,a.lpFilterCutoff,a.lpFilterCutoffSweep,a.lpFilterResonance,a.hpFilterCutoff,a.hpFilterCutoffSweep,.5];return{generatePickupCoin:()=>{let b=Object.assign({},defaultSynth);return b.startFrequency=.4+Math.random()*.5,b.sustainTime=Math.random()*.1,b.decayTime=.1+Math.random()*.4,b.sustainPunch=.3+Math.random()*.3,Math.random()<.5&&(b.changeSpeed=.5+Math.random()*.2,b.changeAmount=.2+Math.random()*.4),a(b)},generateLaserShoot:()=>{let b=Object.assign({},defaultSynth);return b.waveType=Math.floor(Math.random()*3),b.waveType==2&&Math.random()<.5&&(b.waveType=Math.floor(Math.random()*2)),b.startFrequency=.5+Math.random()*.5,b.minFrequency=b.startFrequency-.2-Math.random()*.6,b.minFrequency<.2&&(b.minFrequency=.2),b.slide=-.15-Math.random()*.2,Math.random()<.33&&(b.startFrequency=.3+Math.random()*.6,b.minFrequency=Math.random()*.1,b.slide=-.35-Math.random()*.3),Math.random()<.5?(b.squareDuty=Math.random()*.5,b.dutySweep=Math.random()*.2):(b.squareDuty=.4+Math.random()*.5,b.dutySweep=-Math.random()*.7),b.sustainTime=.1+Math.random()*.2,b.decayTime=Math.random()*.4,Math.random()<.5&&(b.sustainPunch=Math.random()*.3),Math.random()<.33&&(b.phaserOffset=Math.random()*.2,b.phaserSweep=-Math.random()*.2),Math.random()<.5&&(b.hpFilterCutoff=Math.random()*.3),a(b)},generateExplosion:()=>{let b=Object.assign({},defaultSynth);return b.waveType=3,Math.random()<.5?(b.startFrequency=.1+Math.random()*.4,b.slide=-.1+Math.random()*.4):(b.startFrequency=.2+Math.random()*.7,b.slide=-.2-Math.random()*.2),b.startFrequency*=b.startFrequency,Math.random()<.2&&(b.slide=0),Math.random()<.33&&(b.repeatSpeed=.3+Math.random()*.5),b.sustainTime=.1+Math.random()*.3,b.decayTime=Math.random()*.5,b.sustainPunch=.2+Math.random()*.6,Math.random()<.5&&(b.phaserOffset=-.3+Math.random()*.9,b.phaserSweep=-Math.random()*.3),Math.random()<.33&&(b.changeSpeed=.6+Math.random()*.3,b.changeAmount=.8-Math.random()*1.6),a(b)},generatePowerup:()=>{let b=Object.assign({},defaultSynth);return Math.random()<.5?b.waveType=1:b.squareDuty=Math.random()*.6,Math.random()<.5?(b.startFrequency=.2+Math.random()*.3,b.slide=.1+Math.random()*.4,b.repeatSpeed=.4+Math.random()*.4):(b.startFrequency=.2+Math.random()*.3,b.slide=5+Math.random()*.2,Math.random()<.5&&(b.vibratoDepth=Math.random()*.7,b.vibratoSpeed=Math.random()*.6)),b.sustainTime=Math.random()*.4,b.decayTime=.1+Math.random()*.4,a(b)},generateHitHurt:()=>{let b=Object.assign({},defaultSynth);return b.waveType=Math.floor(Math.random()*3),b.waveType==2?b.waveType=3:b.waveType==0&&(b.squareDuty=Math.random()*.6),b.startFrequency=.2+Math.random()*.6,b.slide=-.3-Math.random()*.4,b.sustainTime=Math.random()*.1,b.decayTime=.1+Math.random()*.2,Math.random()<.5&&(b.hpFilterCutoff=Math.random()*.3),a(b)},generateJump:()=>{let b=Object.assign({},defaultSynth);return b.waveType=0,b.squareDuty=Math.random()*.6,b.startFrequency=.3+Math.random()*.3,b.slide=.1+Math.random()*.2,b.sustainTime=.1+Math.random()*.3,b.decayTime=.1+Math.random()*.2,Math.random()<.5&&(b.hpFilterCutoff=Math.random()*.3),Math.random()<.5&&(b.lpFilterCutoff=1-Math.random()*.6),a(b)},generateBlipSelect:()=>{let b=Object.assign({},defaultSynth);return b.waveType=Math.floor(Math.random()*2),b.waveType==0&&(b.squareDuty=Math.random()*.6),b.startFrequency=.2+Math.random()*.4,b.sustainTime=.1+Math.random()*.1,b.decayTime=Math.random()*.2,b.hpFilterCutoff=.1,a(b)}}})(),m=(a,b,c,d)=>((Math.atan2(d-b,c-a))*180/Math.PI),n=(c,d,a,b)=>(Math.sqrt((a-=c)*a+(b-=d)*b)),o=(a,b)=>((Math.cos(b*Math.PI/180))*a),q=(a,b)=>((Math.sin(b*Math.PI/180))*a),motionAdd=(a,d,e)=>{let b=o(a.e,a.d)+o(d,e);let c=q(a.e,a.d)+q(d,e);a.e=Math.hypot(b,c),a.d=m(0,0,b,c)},randomSign=()=>Math.random()>.5?-1:1,a=(a,b,c)=>{for(let d=0;d<a.elements.length;d++)a.elements[d].transform.baseVal[0].matrix.e=b,a.elements[d].transform.baseVal[0].matrix.f=c},b=(a,b,c,d)=>{for(let e=0;e<a.elements.length;e++)a.elements[e].children[0].transform.baseVal[1].setRotate(b,c,d)},createExplosion=(a,b,c)=>{playSound(c,a,b);for(let d=0;d<4;d++)ad.push({x:a+(Math.random()*20-10),y:b+(Math.random()*20-10),node:nodeCreate('explosion','.topLayer',a=>{a.children[0].style.fill=['#FD6D0A','#FE9923','#FFDE03','#fff'][Math.floor(d)]}),life:50,e:Math.random()/4,d:Math.random()*360,animate:(a,b)=>{b.children[0].r.baseVal.value=a.life/2+20,b.children[0].style.opacity=.02*a.life}})},emit=(c,d,a,b)=>{if(Math.random()>quality)return;ad.push({x:c+o(-a,b),y:d+q(-a,b),node:nodeCreate('bubbleParticle','.bottomLayer'),life:120,e:a/10,d:b-180+(Math.random()*30-15),animate:(a,b)=>{b.children[0].style.opacity=.03333333333333333*a.life}})},applyGravity=a=>{for(let b=0;b<planets.length;b++){let c=n(a.x,a.y,planets[b].x,planets[b].y);let d=m(a.x,a.y,planets[b].x,planets[b].y);motionAdd(a,1/a.mass*gravityPower*(a.mass*planets[b].mass)/(c*c),d)}},moveGameObjects=c=>{for(let d=0;d<c.length;d++)c[d].x+=o(c[d].e,c[d].d),c[d].y+=q(c[d].e,c[d].d),a(c[d].node,c[d].x,c[d].y),b(c[d].node,c[d].d,c[d].aa,c[d].ab)},moveGameObjects2=c=>{for(let d=0;d<c.length;d++){if(c[d].glitching||c[d].dead)continue;motionAdd(c[d],c[d].currentAcceleration,c[d].facing),c[d].currentAcceleration=0,c[d].e=Math.min(c[d].e,c[d].f),c[d].x+=o(c[d].e,c[d].d),c[d].y+=q(c[d].e,c[d].d),a(c[d].node,c[d].x,c[d].y),b(c[d].node,c[d].facing,c[d].aa,c[d].ab)}},destroy=(a,b)=>{nodeDestroy(a[b].node),a.splice(b,1)},nodes={},nodeCreate=(a,e,d)=>{if(nodes[a]||(nodes[a]=[]),!nodes[a].length){let c=[];for(let f=0;f<panes.length;f++){let g=window[a].cloneNode(!0);g.id='',c.push(g),panes[f].querySelector(e).appendChild(g)}nodes[a].push({baseNode:a,elements:c})}let b=nodes[a].pop();for(let f=0;f<b.elements.length;f++)b.elements[f].style.display='',b.elements[f].style.opacity=1,d&&d(b.elements[f],f);return b},nodeDestroy=a=>{for(let b=0;b<a.elements.length;b++)a.elements[b].style.display='none';nodes[a.baseNode].push(a)},checkCollisions=(a,b)=>{if(a.dead)return;for(let c=0;c<b.length;c++){if(a.owner&&a.owner.id==b[c].id)continue;if(collisionDistance=n(a.x,a.y,b[c].x,b[c].y),collisionDistance<a.collisionRadius+b[c].collisionRadius){if(a.life=0,b[c].life-=a.damage,b[c].type==='cpu')for(let c=0;c<players.length;c++)players[c].id===a.owner.id&&(players[c].points++,split||(killCount.innerText=players[c].points));break}}},buttonMoveDown=!1,buttonShootDown=!1,buttonTurnLeftDown=!1,buttonTurnRightDown=!1,buttonGlitchDown=!1,document.body.onkeydown=a=>{a.which==38&&(buttonMoveDown=!0),a.which==37&&(buttonTurnLeftDown=!0),a.which==39&&(buttonTurnRightDown=!0),a.which==17&&(buttonShootDown=!0),a.which==16&&(buttonGlitchDown=!0)},document.body.onkeyup=a=>{a.which==38&&(buttonMoveDown=!1),a.which==37&&(buttonTurnLeftDown=!1),a.which==39&&(buttonTurnRightDown=!1),a.which==17&&(buttonShootDown=!1),a.which==16&&(buttonGlitchDown=!1)},controlKeyboardUpdate=a=>{buttonMoveDown&&(players[a].currentAcceleration=players[a].l),buttonTurnLeftDown?players[a].g=Math.max(players[a].g-players[a].k,-players[a].h):buttonTurnRightDown?players[a].g=Math.min(players[a].g+players[a].k,players[a].h):players[a].g/=players[a].turnFriction,buttonGlitchDown&&(players[a].glitch=!0),buttonShootDown&&(players[a].shoot=!0)},controlGamepadUpdate=(c,b)=>{let a=navigator.getGamepads();if(!a[b])return;a[b].buttons[0].pressed&&(players[c].shoot=!0),a[b].buttons[2].pressed&&(players[c].glitch=!0),a[b].buttons[7].value>.2&&(players[c].currentAcceleration=a[b].buttons[7].value*players[c].l),a[b].axes[0]>.3||a[b].axes[0]<-.3?players[c].g=Math.round(a[b].axes[0]*players[c].h):players[c].g/=players[c].turnFriction,a[b].buttons[6].pressed&&(zoom+=.1,zoom=Math.min(10,zoom)),a[b].buttons[4].pressed&&(zoom-=.1,zoom=Math.max(.1,zoom))},ai=a=>{closestPlayer=0,closestPlayerDistance=0;for(let b=0;b<players.length;b++)playerDisatance=n(a.x,a.y,players[b].x,players[b].y),(!closestPlayer||closestPlayerDistance>playerDisatance)&&(closestPlayer=players[b],closestPlayerDistance=playerDisatance);Math.random()<.8?(a.currentAcceleration=a.l,u=(a.facing-m(a.x,a.y,closestPlayer.x,closestPlayer.y)+360)%360,closestPlayerDistance<800&&(u=-u+360),closestPlayerDistance<400&&Math.random()<.2&&(a.glitch=!0),u<180?u>3?a.g=Math.max(a.g-a.k,-a.h):(closestPlayerDistance<1e3&&(a.shoot=!0),a.g/=1.2):u>180&&(u<357?a.g=Math.min(a.g+a.k,a.h):(closestPlayerDistance<1e3&&(a.shoot=!0),a.g/=1.2))):(a.currentAccelleration=0,a.g/=1.2)},startTimer=null,startCountDown=0,playerJoined={},stateStartInit=()=>{svgStartNode.style.display='block',svgDeadNode.style.display='none',state=stateStart},countDown=()=>{startCountDown--,startCountDown<=0?stateGameInit():(startText.textContent=startCountDown,startTimer=setTimeout(countDown,500))},stateStart=()=>{buttonShootDown&&!playerJoined.keyboard&&(playerJoined.keyboard=!0,playerInputs.push([controlKeyboardUpdate]),startTimer&&clearTimeout(startTimer),startText.classList.remove('blink'),split&&playerInputs.length<2?startText.textContent='Waiting for w 2':(startCountDown=3,startText.textContent=startCountDown,startTimer=setTimeout(countDown,500)));let a=navigator.getGamepads();for(let b=0;b<a.length;b++){if(!a[b])continue;for(let c=0;c<a[b].buttons.length;c++)a[b]&&a[b].buttons[c].pressed&&!playerJoined['gamepad'+b]&&(playerJoined['gamepad'+b]=!0,playerInputs.push([controlGamepadUpdate,b]),startTimer&&clearTimeout(startTimer),split&&playerInputs.length<2?startText.textContent='Waiting for w 2':(startText.classList.remove('blink'),startCountDown=3,startText.textContent=startCountDown,startTimer=setTimeout(countDown,500)))}},stateGameInit=()=>{svgStartNode.style.display='none',svgDeadNode.style.display='none',state=stateGame,createSolarSystem(solarSystemData),playerInputs.forEach(()=>{createPlayer({ah:5})}),split||(hudLayerBottom.style.display='block',updateTimeElapsed(),killCount.innerText=elapsedTime.innetText='0',createHud(hudData,players[0])),t(0,!0)},stateGame=()=>{for(let b=0;b<planets.length;b++){planets[b].angle+=planets[b].orbitSpeed,planets[b].x=o(planets[b].distance,planets[b].angle),planets[b].y=q(planets[b].distance,planets[b].angle),a(planets[b].node,planets[b].x,planets[b].y);for(let a=0;a<planets[b].node.elements.length;a++)planets[b].node.elements[a].children[planets[b].node.elements[a].children.length-1].transform.baseVal[0].setRotate(m(0,0,planets[b].x,planets[b].y),0,0)}for(let a=0;a<players.length;a++){if(checkCollisions(players[a],planets),players[a].life>0){applyGravity(players[a]),playerInputs[a][0](a,playerInputs[a][1]),updatePlayer(players[a]),players[a].life>0&&(players[a].life+=.005,players[a].life>players[a].lifeMax&&(players[a].life=players[a].lifeMax),players[a].glitchCharge+=.2,players[a].glitchCharge>players[a].glitchMax&&(players[a].glitchCharge=players[a].glitchMax));let b=9999999;let c=null;for(let d=0;d<players.length;d++){if(a===d)continue;let e=n(players[a].x,players[a].y,players[d].x,players[d].y);e<b&&(b=e,c=players[d])}for(let d=0;d<cpus.length;d++){let e=n(players[a].x,players[a].y,cpus[d].x,cpus[d].y);e<b&&(b=e,c=cpus[d])}let d=players[a].node.elements[a].children[1].children[0];if(c!==null){let e=m(players[a].x,players[a].y,c.x,c.y);b/=20,b<70?b=70:b>200&&(b=200),d.transform.baseVal[0].matrix.e=o(b,e-90),d.transform.baseVal[0].matrix.f=q(b,e-90),d.children[0].transform.baseVal[0].setRotate(e-90,0,0),d.style.display=''}else d.style.display='none';split||(updateHud(players[a],players[a].life,players[a].lifeMax,'life'),updateHud(players[a],players[a].glitchCharge,players[a].glitchMax,'glitch'))}else{if(!players[a].dead){createExplosion(players[a].x,players[a].y,players[a].explosionSound),players[a].dead=!0;for(let b=0;b<players[a].node.elements.length;b++)players[a].node.elements[b].style.display='none'}split||destroy(players,a)}if(split&&players[a].dead&&(players[a].life--,players[a].life<-100)){players[a].dead=!1;for(let b=0;b<players[a].node.elements.length;b++)players[a].node.elements[b].style.display='';players[a].life=players[a].lifeMax,players[a].e=0,spawnPlayer(players[a])}}for(let a=0;a<cpus.length;a++)checkCollisions(cpus[a],planets),cpus[a].life>0?(applyGravity(cpus[a]),ai(cpus[a]),updatePlayer(cpus[a]),cpus[a].glitchCharge+=.2,cpus[a].glitchCharge>cpus[a].glitchMax&&(cpus[a].glitchCharge=cpus[a].glitchMax)):(createExplosion(cpus[a].x,cpus[a].y,cpus[a].explosionSound),destroy(cpus,a));for(let d=0;d<glitches.length;d++){if(glitches[d].delay!==null&&glitches[d].delay--<0){let c=glitches[d].glitchLog[0];for(let a=0;a<30;a++)ad.push({x:c[0]+o(Math.random()*50-25,c[2]),y:c[1]+q(Math.random()*50-25,c[2]),node:nodeCreate('glitchParticle','.glitchLayer',a=>{a.children[0].style.fill=['#9417FF','#5A30CC','#9417FF','#fff'][Math.floor(Math.random()*4)],a.children[0].style.opacity=Math.random(),a.children[0].transform.baseVal[0].setRotate(c[2],0,0),a.children[0].transform.baseVal[1].setScale(1,1)}),life:100,e:Math.random()*2,d:a%2==0?c[2]+90:c[2]-90,animate:(a,b)=>{b.children[0].transform.baseVal[1].setScale(.02*a.life,.02*a.life),b.children[0].style.opacity=.02*a.life}});glitches[d].delay=null;for(let a=0;a<glitches[d].node.elements.length;a++)glitches[d].node.elements[a].style.display=''}if(glitches[d].delay===null){let c=glitches[d].glitchLog.shift();if(a(glitches[d].node,c[0],c[1]),b(glitches[d].node,c[2],glitches[d].aa,glitches[d].ab),c[3]>.1&&emit(c[0],c[1],25,c[2]),c[4]&&(playSound(glitches[d].owner.shootSound,c[0],c[1]),bullets.push({owner:glitches[d].owner,node:nodeCreate('bullet','.bottomLayer'),aa:0,ab:0,x:c[0]+o(glitches[d].owner.gunMounts[c[5]],c[2]+90),y:c[1]+q(glitches[d].owner.gunMounts[c[5]],c[2]+90),d:c[2],e:30,life:60,mass:.8,collisionRadius:10,damage:1})),!glitches[d].glitchLog.length){for(let a=0;a<30;a++)ad.push({x:c[0]+o(Math.random()*50-25,c[2]),y:c[1]+q(Math.random()*50-25,c[2]),node:nodeCreate('glitchParticle','.glitchLayer',a=>{a.children[0].style.fill=['#9417FF','#5A30CC','#9417FF','#fff'][Math.floor(Math.random()*4)],a.children[0].style.opacity=Math.random(),a.children[0].transform.baseVal[0].setRotate(c[2],0,0),a.children[0].transform.baseVal[1].setScale(1,1)}),life:100,e:Math.random()*2,d:a%2==0?c[2]+90:c[2]-90,animate:(a,b)=>{b.children[0].transform.baseVal[1].setScale(.02*a.life,.02*a.life),b.children[0].style.opacity=.02*a.life}});destroy(glitches,d)}}}moveGameObjects2(players),moveGameObjects2(cpus),moveGameObjects(bullets);for(let a=0;a<bullets.length;a++)applyGravity(bullets[a]),checkCollisions(bullets[a],players),checkCollisions(bullets[a],cpus),checkCollisions(bullets[a],planets),bullets[a].life<=0&&(bullets[a].explode=!0),bullets[a].life--,bullets[a].life<=0&&(bullets[a].explode&&createExplosion(bullets[a].x,bullets[a].y,bullets[a].owner.explosionSound),destroy(bullets,a));for(let b=0;b<ad.length;b++){ad[b].x+=o(ad[b].e,ad[b].d),ad[b].y+=q(ad[b].e,ad[b].d);for(let a=0;a<ad[b].node.elements.length;a++)ad[b].animate(ad[b],ad[b].node.elements[a]);a(ad[b].node,ad[b].x,ad[b].y),ad[b].life--,ad[b].life<0&&destroy(ad,b)}for(let a=0;a<panes.length;a++)players[a]&&(panes[a].viewBox.baseVal.x=players[a].x-window.innerWidth*zoom/2,panes[a].viewBox.baseVal.y=players[a].y-window.innerHeight*zoom/2,panes[a].viewBox.baseVal.width=window.innerWidth*zoom,panes[a].viewBox.baseVal.height=window.innerHeight*zoom);if(playerInputs.length===1&&players[0])while(cpus.length<players[0].points/3+1)createCpu({lifeMax:1});split||players.length||stateDeadInit()},stateDeadInit=()=>{svgStartNode.style.display='none',svgDeadNode.style.display='block',state=stateDead,timeElapsedID&&(clearInterval(timeElapsedID),timeElapsedID=!1,timeElapsed=0);while(players.length)destroy(players,0);while(cpus.length)destroy(cpus,0);while(ad.length)destroy(ad,0);while(bullets.length)destroy(bullets,0);while(glitches.length)destroy(glitches,0);while(planets.length)destroy(planets,0);while(hudLayer.firstChild)hudLayer.removeChild(hudLayer.firstChild);canRestart=!1,setTimeout(()=>{canRestart=!0},2e3)},stateDead=()=>{if(!canRestart)return;buttonShootDown&&location.reload();let a=navigator.getGamepads();for(let b=0;b<a.length;b++){if(!a[b])continue;for(let c=0;c<a[b].buttons.length;c++)a[b]&&a[b].buttons[c].pressed&&location.reload()}},bullets=[],cpus=[],glitches=[],gravityPower=2500,low=location.search.indexOf('low')!==-1,planets=[],players=[],playerInputs=[],ad=[],quality=low?.1:1,split=location.search.indexOf('split')!==-1,timeElapsed=0,timeElapsedID=!1,zoom=2,glitchColors={human:['#9417FF','#5A30CC','#9417FF','#fff'],cpu:['#e0421d','#ed4559','#e0421d','#fff']},setGameState=(a,b)=>{split=a,low=b,location=(split?'?split,':'?cpu,')+(low?'low':'high')},updateLinkClass=(b,c)=>{els=document.getElementsByClassName(b);for(var a=0;a<els.length;a++)els[a].className+=c},updateButtons=()=>{c=location.search.substr(1).split(',');for(var a=0;a<c.length;++a)updateLinkClass(c[a],' active')},updateTimeElapsed=()=>{timeElapsedID=setInterval(()=>{elapsedTime.innerText=++timeElapsed},1e3)},split?panes=[document.querySelector('.splitLeft'),document.querySelector('.splitRight')]:(panes=[document.querySelector('.splitLeft')],panes[0].style.width='100vw'),createNodes=(a,b,c)=>{for(let d=0;d<panes.length;d++)for(let d=0;d<panes.length;d++)while(a.length<1e3){let e=b.cloneNode(!0);e.id='',panes[d].querySelector(c).appendChild(e),a.push(e)}},createSolarSystem=()=>{let a=['sunStar','planetOrange','planetBlue','planetGrey','planetOrange','planetBlue','planetGrey'];for(let b=0;b<a.length;b++){let c=b>0?Math.random()+.5:3;let d={node:nodeCreate(a[b],'.planetLayer',a=>{a.transform.baseVal[1].setScale(c,c)}),distance:1e3*b,angle:Math.random()*360,scale:c,mass:c*10,collisionRadius:c*100,orbitSpeed:.1-1e-5*(300*b)};planets.push(d)}},solarSystemData={stars:{count:2e3*quality,field:{width:window.innerWidth*15,height:window.innerHeight*15}}};for(let a=0;a<panes.length;a++)for(let c=0;c<solarSystemData.stars.count;c++){let b=starNode.cloneNode(!0);b.id='',b.r.baseVal.value=Math.random()*5,b.cx.baseVal.value=solarSystemData.stars.field.width*2*Math.random()-solarSystemData.stars.field.width,b.cy.baseVal.value=solarSystemData.stars.field.height*2*Math.random()-solarSystemData.stars.field.height,b.style.opacity=Math.random(),b.style.fill='#c0f7ff',Math.random()<=.5?b.style.fill='#fff':Math.random()<=.5&&(b.style.fill='#fffec4'),panes[a].querySelector('.stars').appendChild(b)}createPlayer=e=>{let b=0,c=0,d;do{d=9999999,b+=Math.random()*1e4-5e3,c+=Math.random()*1e4-5e3;for(let f=0;f<planets.length;f++){let g=Math.abs(n(b,c,o(planets[f].distance,planets[f].angle),q(planets[f].distance,planets[f].angle)));g<d&&(d=g)}}while(d<1e3);let a={id:Math.floor(Math.random()*1e6),type:'human',node:nodeCreate('ay','.topLayer',(a,b)=>{b!==players.length&&(a.children[1].style.display='none')}),aa:33.5,ab:26.5,hud:{},life:split?10:20,lifeMax:split?10:20,glitch:!1,glitchCharge:0,glitchMax:20,glitchLog:[],glitchReloadTime:30,glitchReloading:30,glitching:!1,shootSound:createSound(soundGenerator.generateLaserShoot()),glitchSound:createSound(soundGenerator.generateJump()),explosionSound:createSound(soundGenerator.generateHitHurt()),x:b,y:c,d:0,facing:0,e:0,mass:1,collisionRadius:30,f:15,l:.4,friction:1.1,g:0,h:5,k:.5,turnFriction:1.2,currentAcceleration:0,shoot:!1,ag:0,ah:10,gunMount:0,gunMounts:[20,-20],points:0};for(let f in e)a[f]=e[f];a.life=a.lifeMax,players.push(a)},createCpu=a=>{createPlayer(a),cpuPlayer=players.pop(),cpuPlayer.type='cpu',cpuPlayer.node.elements[0].classList='player2',cpus.push(cpuPlayer)},spawnPlayer=d=>{let b=0,c=0,a;do{a=9999999,b+=Math.random()*200-100,c+=Math.random()*200-100;for(let e=0;e<planets.length;e++){let f=Math.abs(n(b,c,o(planets[e].distance,planets[e].angle),q(planets[e].distance,planets[e].angle)));f<a&&(a=f)}for(let e=0;e<players.length;e++){let f=Math.abs(n(b,c,players[e].x,players[e].y));f<a&&(a=f)}for(let e=0;e<cpus.length;e++){let f=Math.abs(n(b,c,cpus[e].x,cpus[e].y));f<a&&(a=f)}for(let e=0;e<glitches.length;e++){let f=Math.abs(n(b,c,glitches[e].glitchLog[0][0],glitches[e].glitchLog[0][1]));f<a&&(a=f)}}while(a<700);d.x=b,d.y=c},updatePlayer=a=>{a.facing+=a.g;while(a.facing>360)a.facing-=360;while(a.facing<0)a.facing+=360;if(a.currentAcceleration>.1&&!a.glitching&&emit(a.x,a.y,25,a.facing),a.glitch&&a.glitchReloading<0&&a.glitchCharge>=a.glitchMax){for(let b=0;b<30;b++)ad.push({x:a.x+o(Math.random()*50-25,a.facing),y:a.y+q(Math.random()*50-25,a.facing),node:nodeCreate('glitchParticle','.glitchLayer',b=>{b.children[0].style.fill=glitchColors[a.type][Math.floor(Math.random()*4)],b.children[0].style.opacity=Math.random(),b.children[0].transform.baseVal[0].setRotate(a.facing,0,0),b.children[0].transform.baseVal[1].setScale(1,1)}),life:100,e:Math.random()*2,d:b%2==0?a.facing+90:a.facing-90,animate:(a,b)=>{b.children[0].transform.baseVal[1].setScale(.02*a.life,.02*a.life),b.children[0].style.opacity=.02*a.life}});playSound(a.glitchSound,a.x,a.y),a.glitchCharge=0,a.glitching=!0,a.glitchReloading=a.glitchReloadTime;for(let b=0;b<a.node.elements.length;b++)a.node.elements[b].style.display='none';a.e=0}if(a.glitching&&a.glitchReloading<0){a.glitching=!1;for(let b=0;b<a.node.elements.length;b++)a.node.elements[b].style.display='';glitches.push({owner:a,node:nodeCreate('ay','.topLayer',b=>{b.style.display='none',b.children[1].children[0].style.display='none',a.type==='cpu'&&(b.classList='player2')}),aa:33.5,ab:26.5,delay:Math.random()*100,glitchLog:a.glitchLog}),a.glitchLog=[],spawnPlayer(a)}a.glitching||a.glitchLog.push([a.x,a.y,a.facing,a.currentAcceleration,a.shoot&&a.ag<0&&!a.glitching,a.gunMount]),a.shoot&&a.ag<0&&!a.glitching&&(playSound(a.shootSound,a.x,a.y),a.ag=a.ah,bullets.push({owner:a,node:nodeCreate('bullet','.bottomLayer'),aa:0,ab:0,x:a.x+o(a.gunMounts[a.gunMount],a.facing+90),y:a.y+q(a.gunMounts[a.gunMount],a.facing+90),d:a.facing,e:30,life:60,mass:.8,collisionRadius:10,damage:1}),a.gunMount++,a.gunMount>=a.gunMounts.length&&(a.gunMount=0)),a.glitchReloading--,a.glitch=!1,a.ag--,a.shoot=!1},createHud=(b,c)=>{for(let d=0;d<b.length;d++){let e=hud.cloneNode(!0);if(e.id='hud'+b[d].id.charAt(0).toUpperCase()+b[d].id.substr(1).toLowerCase(),hScale=window.innerWidth/900*.1+.5,e.transform.baseVal[1].setScale(hScale,hScale),b[d].hasOwnProperty('hAlign')&&b[d].hAlign==='right'){e.setAttributeNS(null,'class','hudRight');let g=e.children[0].children[0];let h=436;g.transform.baseVal[1].setScale(-1,1),a({elements:[g]},h,0),a({elements:[e.children[0].children[1]]},h-112,76)}let f=e.children[1];e.children[0].children[1].innerHTML=b[d].text;for(let a=0;a<c.lifeMax;a++){let e=a==0?f.children[0]:f.children[0].cloneNode(!0);e.setAttributeNS(null,'x',a*b[d].bars.offset),a>=c[b[d].id]&&e.setAttributeNS(null,'class','hudBar hudBarE'),f.appendChild(e)}e.style.display='',hudLayer.appendChild(e),c.hud[b[d].id]={data:b[d],element:hudLayer.children[hudLayer.children.length-1]}}},updateHud=(a,c,e,b)=>{if(c>=0&&c<=e){let d='hudBar';for(let f=0;f<a.hud[b].element.children[1].children.length;f++){f>=c&&(d+=' hudBarE');let g=a.hud[b].data.hAlign==='right'?a.hud[b].element.children[1].children.length-(f+1):f;a.hud[b].element.children[1].children[g].classList=d}}},hudData=[{id:'glitch',hAlign:'right',bars:{width:16,offset:22},text:'GLITCH'},{id:'life',bars:{width:16,offset:22},text:'HEALTH'}],t=(b,a)=>{state(),a!==!0&&requestAnimationFrame(t)},stateStartInit(),updateButtons(),t()</script>